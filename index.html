<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title> Running Lines </title>
		<link rel="stylesheet" type="text/css" href="index.css">
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<!--<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"> </script>
		<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">-->
		<script type="text/javascript">
		//----- Website Formatting
		function showCharBox(){
<<<<<<< HEAD
			var numChars = document.getElementById("numChars").value;
			alert(numChars);
			var charactersettings = document.getElementById('charactersettings');
			document.getElementById('charactersettings').innerHTML = "";
			for (var character = 0; character < numChars; character++){
				document.getElementById('charactersettings').innerHTML += "<p class='characters' id="+(character+1)+" onhover='hoverCharacter("+(character+1)+")' onclick='setMyCharacter("+(character+1)+")'><label>Character "+(character+1)+" <input type='text' placeholder='Type here.' onchange='AddtoCharacterList("+(character+1)+")'></p></label>";
=======
			var dropdown = document.getElementById("numChars");
			var numChars = dropdown.value;
			document.getElementById('charactersettings').innerHTML = "";
			for (var character = 0; character < numChars; character++){
				document.getElementById('charactersettings').innerHTML += "<p class='characters' id='character"+(character+1)+"'><label>Character "+(character+1)+' </label><input type="text" onblur="if (this.value) AddtoCharacterList(this.value)" placeholder="Type here."></p>';// onclick='if (this.value) setMyCharacter("+(character+1)+")'
>>>>>>> 04d54884e3c393af16a7216424107ade93dcf4ea
			}
		}
		function hoverCharacter(idofcharacter){
			document.getElementById(idofcharacter).style("color:red");
		}
		//---- variables based on user settings (characters, female/male, etc)-----
<<<<<<< HEAD
		function AddtoCharacterList(idofcharacter){
			var othercharacters = new Array();
			othercharacters.push(document.getElementbyId(idofcharacter).value);
			//if my character, remove from othercharacters

		}
		function setMyCharacter(idofcharacter){
			if (typeof document.getElementbyId(idofcharacter).value != "undefined"){ 
				var myCharacter = document.getElementbyId(idofcharacter).value;
			}
			othercharacters.remove(myCharacter);
=======
		function AddtoCharacterList(value){
			if (others.indexOf(value)==-1){
				others.push(value);
			}
			alert(others);
>>>>>>> 04d54884e3c393af16a7216424107ade93dcf4ea
		}
		// function setMyCharacter(idofcharacter){
// 			if ($("#character"+String(idofcharacter)).val() !== undefined){
// 				alert($("#character"+String(idofcharacter)).val());
// 				var myCharacter = $("#character"+String(idofcharacter)).val();
// 				var i = others.indexOf(myCharacter);
// 				if(i != -1) {
// 					others.splice(i, 1);
// 				}
// 			}
// 			
// 		}
		//-------for reading the text file input ------
			window.onload = function() {
				var fileInput = document.getElementById('fileInput');

				fileInput.addEventListener('change', function(e) {
					var file = fileInput.files[0];
					var textType = /text.*/;
					if (file.type.match(textType)) {
						var reader = new FileReader();
						reader.onload = function(e) {
							var alltext = parseInput(reader.result);
							runLines(alltext);
						}
						reader.readAsText(file);	
					} 
					else {
						fileDisplayArea.innerText = "File not supported!";
					}
				});
			}
			function parseInput(alllines){ //creates a nested list: [[character,line],[character,line]] etc
				var basicRtfPattern = /\{\*?\\[^{}]+}|[{}]|\\[A-Za-z]+\n?(?:-?\d+)?[ ]?/g;
				var newLineSlashesPattern = /\\\n/g;

				var stripped = alllines.replace(basicRtfPattern,"");
				stripped = stripped.trim();

				var lines = stripped.split('\n');
				var chlinepairs = new Array();

				for (var ln = 0; ln < lines.length; ln++) {  //ln stands for line number
					chlinepairs[ln] = new Array();
					var newl = lines[ln];
					if (newl[newl.length-1]=="\\"){ //if last ch is \, remove
						newl = newl.slice(0,-1);
					}
					newl = newl.split(" \\'97"); //splits on double dash
					chlinepairs[ln][0] = newl[0];
					chlinepairs[ln][1] = newl[1];
				}
				alert(chlinepairs);
				return chlinepairs;

			}
		// -------SPEAK Text----
			function runLines(chlinepairs){
				//if the character is not == the user's character:
				for (currline = 0; currline < chlinepairs.length; currline++){
					alert(chlinepairs[currline][0]);
					if (othercharacters.indexOf(chlinepairs[currline][0])>=0){
						speak(chlinepairs[currline][1]);
					}
					else{
						alert("your turn!");
					}
				}

			}
			function speak(line){
				var toSpeak = new SpeechSynthesisUtterance(line);
				window.speechSynthesis.speak(toSpeak);
			}

			// If record button pressed, speech api starts to listen. var talking = user
			// If record button pressed again, speech api stops listening. var talking = computer

		</script>	
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">
<link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap-theme.min.css">
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<style type="text/css">
	.hello-example{
margin: 20px;
	}
</style>
	</head>
	
	<body>
<<<<<<< HEAD
=======
		<script>
			var others = new Array();
		</script>
		<!--<div>
      		<input type="file" id="fileInput"> <!--input prompt for text file-->
		</div>-->
>>>>>>> 04d54884e3c393af16a7216424107ade93dcf4ea
		
<!--		<p> <form>
		<fieldset>
<<<<<<< HEAD
=======
			<legend>File</legend>
				<input type="file" id="fileInput"> <!--input prompt for text file-->
>>>>>>> 04d54884e3c393af16a7216424107ade93dcf4ea
			<legend>Characters</legend>
				<select id= "numChars" onchange="showCharBox()">
					<option></option>
					<option>1</option>
					<option>2</option>
					<option>3</option>
					<option>4</option>
					<option>5</option>
					<option>6</option>
				</select>
				<p id= "charactersettings">
				<!--
				<p> <label>Character 1
				<input type="text" placeholder="Type here.">
				</p>
				</label>
				
				<p> <label>Character 2
				<input type="text" placeholder="Type here.">
				</p>
				</label>
				
				<p> <label>Character 3
				<input type="text" placeholder="Type here.">
				</p>
				</label>
<<<<<<< HEAD
				
				</div>
=======
				-->
				</p>
>>>>>>> 04d54884e3c393af16a7216424107ade93dcf4ea
		</fieldset>
		</form>
		</p>		
		-->
		
	<div class="hello-example">
	<ul class="nav nav-tabs" id="myTab">
        <li class="active"><a data-toggle="tab" href="#file">File</a></li>
        <li class=""><a data-toggle="tab" href="#characters">Characters</a></li>
	</ul>	
	</div>

	</body>
</html>